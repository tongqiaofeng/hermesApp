require('./common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["hermes/inventory"],{261:function(t,e,n){"use strict";(function(t){n(5);o(n(3));var e=o(n(262));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=n,t(e.default)}).call(this,n(1)["createPage"])},262:function(t,e,n){"use strict";n.r(e);var o=n(263),a=n(265);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);n(267);var r,i=n(11),c=Object(i["default"])(a["default"],o["render"],o["staticRenderFns"],!1,null,"2d08db41",null,!1,o["components"],r);c.options.__file="hermes/inventory.vue",e["default"]=c.exports},263:function(t,e,n){"use strict";n.r(e);var o=n(264);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},264:function(t,e,n){"use strict";var o;n.r(e),n.d(e,"render",(function(){return a})),n.d(e,"staticRenderFns",(function(){return r})),n.d(e,"recyclableRender",(function(){return s})),n.d(e,"components",(function(){return o}));var a=function(){var t=this,e=t.$createElement,n=(t._self._c,0!=t.haveData?t.__map(t.list,(function(e,n){var o=t.__get_orig(e),a=e.pic.trim(),s=e.letter?e.letter.slice(0,1):null,r=e.buyAllPrice?t.getPrice(e.buyAllPrice,e.foreignCurrency,"-",0):null,i=e.totalHkPrice?t.getPrice(e.totalHkPrice,t.currency,"-",0):null,c=e.pricePeer?t.getPrice(e.pricePeer,t.currency,"-",0):null,l=e.priceIndi?t.getPrice(e.priceIndi,t.currency,"-",0):null;return{$orig:o,g0:a,g1:s,m0:r,m1:i,m2:c,m3:l}})):null);t._isMounted||(t.e0=function(e){t.bShowCompany=!0},t.e1=function(e){t.bShowStock=!0},t.e2=function(e){t.bShowState=!0}),t.$mp.data=Object.assign({},{$root:{l0:n}})},s=!1,r=[];a._withStripped=!0},265:function(t,e,n){"use strict";n.r(e);var o=n(266),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=a.a},266:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(125));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,o,a,s,r){try{var i=t[s](r),c=i.value}catch(l){return void n(l)}i.done?e(c):Promise.resolve(c).then(o,a)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var r=t.apply(e,n);function i(t){s(r,o,a,i,c,"next",t)}function c(t){s(r,o,a,i,c,"throw",t)}i(void 0)}))}}var i=function(){n.e("components/popwnd/popwnd_select_blue").then(function(){return resolve(n(439))}.bind(null,n)).catch(n.oe)},c={components:{popwndSelect:i},data:function(){return{currency:"",haveData:1,height:null,keyWord:"",page:1,bShowCompany:!1,companyIdx:0,companys:[{companyId:-1,companyName:"全部公司"}],allStocks:[],bShowStock:!1,stockIdx:0,stocks:[{warehouseId:-1,warehouseName:"全部仓库"}],bShowState:!1,stateIdx:2,states:[{id:-1,name:"全部"},{id:0,name:"采购中"},{id:1,name:"存货"},{id:3,name:"已出售"},{id:8,name:"已寄卖"},{id:2,name:"客人预留"},{id:6,name:"购入退货"},{id:9,name:"客人寄卖"},{id:5,name:"客人取回"},{id:7,name:"遗失"}],list:[],total:0,sold1Total:0,reserveNum:0,soldNum:0,haveMore:0}},onLoad:function(){var e=this;return r(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$onLaunched;case 2:e.currency=getApp().globalData.userInfo.currency,t.getSystemInfo({success:function(t){e.height=t.statusBarHeight}}),e.stateIdx=2,0==e.list.length&&t.getStorageSync("token").length>0&&(console.log("重新获取数据"),e.getStockList());case 6:case"end":return n.stop()}}),n)})))()},onPullDownRefresh:function(){t.showLoading({title:"正在刷新"}),console.log("获取数据"),this.page=1,this.list=[],this.haveMore=0,this.getStockList(),t.stopPullDownRefresh()},onReachBottom:function(){0==this.haveMore&&(this.page++,this.search())},methods:{search:function(){var e=this;t.showLoading({title:"加载中..."}),this.soldNum=0,this.reserveNum=0;var n={};n={keyword:this.keyWord.trim(),userId:0,page:this.page,pageNum:10},this.stateIdx>0&&(n.sold=this.states[this.stateIdx].id),this.companyIdx>0&&(n.companyId=this.companys[this.companyIdx].companyId),this.stockIdx>0&&(n.stockLocId=this.stocks[this.stockIdx].warehouseId),t.request({url:this.$baseFileUrl+"/stockSearch",method:"POST",header:{"content-type":"application/json",token:t.getStorageSync("token")},data:n,complete:function(n){if(t.hideLoading(),0!=e.checkBack(n)){if(e.total=n.data.total,e.sold1Total=n.data.sold1Total,e.reserveNum=n.data.sold2Total,e.soldNum=n.data.soldTotal,0==n.data.list.length)e.haveMore=1;else{var o=e.list.concat(n.data.list);e.list=o}0==e.list.length?(e.haveData=0,t.showToast({icon:"none",title:"暂无数据"})):e.haveData=1}}})},getStockList:function(){var e=this;t.request({url:this.$baseFileUrl+"/stockLocList",header:{"content-type":"application/json",token:t.getStorageSync("token")},data:{},complete:function(n){if(t.hideLoading(),0!=e.checkBack(n,!0)){var o=n.data;if(e.allStocks=[],e.companys=[{companyId:-1,companyName:"全部公司"}],e.stocks=[{warehouseId:-1,warehouseName:"全部仓库"}],o.length>0)for(var a=0;a<o.length;++a){if(o[a].companyId>0){for(var s=!1,r=0;r<e.companys.length;++r)if(e.companys[r].companyId==o[a].companyId){s=!0;break}0==s&&e.companys.push(o[a])}o[a].warehouseId>0&&e.allStocks.push(o[a])}e.companyChange({sel:0})}}})},inputChange:function(){this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},userChange:function(e){this.userIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},companyChange:function(e){this.companyIdx=e.sel,this.stockIdx=0,this.stocks=[{warehouseId:-1,warehouseName:"全部仓库"}];for(var n=0;n<this.allStocks.length;++n)this.companys[this.companyIdx].companyId==this.allStocks[n].companyId&&this.stocks.push(this.allStocks[n]);this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},stockChange:function(e){this.stockIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},stateChange:function(e){this.stateIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},getSaleStateClr:function(t){return 0==t.sold?"#54b7eb":1==t.sold?"#6bcda5":2==t.sold?"#ff8b62":(t.sold,"#ef5b5b")},getSaleState:function(t){for(var e=0;e<this.states.length;++e){if(t.sold==this.states[e].id)return this.states[e].name;if(4==t.sold)return"已售"}return""},checkDetails:function(e){t.navigateTo({url:"details?id="+e.id})},goBack:function(){t.navigateBack({delta:1})}}};e.default=c}).call(this,n(1)["default"])},267:function(t,e,n){"use strict";n.r(e);var o=n(268),a=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,(function(){return o[t]}))}(s);e["default"]=a.a},268:function(t,e,n){}},[[261,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/hermes/inventory.js.map