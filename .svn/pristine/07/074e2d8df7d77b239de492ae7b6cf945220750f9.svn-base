require('./common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["order/orderDetail"],{287:function(e,t,o){"use strict";(function(e){o(5);n(o(3));var t=n(o(288));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o(1)["createPage"])},288:function(e,t,o){"use strict";o.r(t);var n=o(289),r=o(291);for(var a in r)"default"!==a&&function(e){o.d(t,e,(function(){return r[e]}))}(a);o(293);var i,c=o(11),s=Object(c["default"])(r["default"],n["render"],n["staticRenderFns"],!1,null,"24dbe560",null,!1,n["components"],i);s.options.__file="order/orderDetail.vue",t["default"]=s.exports},289:function(e,t,o){"use strict";o.r(t);var n=o(290);o.d(t,"render",(function(){return n["render"]})),o.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),o.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),o.d(t,"components",(function(){return n["components"]}))},290:function(e,t,o){"use strict";var n;o.r(t),o.d(t,"render",(function(){return r})),o.d(t,"staticRenderFns",(function(){return i})),o.d(t,"recyclableRender",(function(){return a})),o.d(t,"components",(function(){return n}));try{n={uniPopup:function(){return o.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(o.bind(null,409))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement,o=(e._self._c,e.__map(e.orderDetail.detailList,(function(t,o){var n=e.__get_orig(t),r=e.formatNumberRgx(t.productPrice);return{$orig:n,m0:r}}))),n=0==e.orderDetail.orderStatus?e.formatNumberRgx(e.payPrice):null;e.$mp.data=Object.assign({},{$root:{l0:o,m1:n}})},a=!1,i=[];r._withStripped=!0},291:function(e,t,o){"use strict";o.r(t);var n=o(292),r=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=r.a},292:function(e,t,o){"use strict";(function(e){function n(e,t){var o;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=r(e))||t&&e&&"number"===typeof e.length){o&&(e=o);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==o.return||o.return()}finally{if(s)throw i}}}}function r(e,t){if(e){if("string"===typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{height:null,detailId:null,orderDetail:{},payPrice:0,verification:{},radioItems:[{name:"微信支付",value:"0",img:o(275),checked:!0}],timeEnd:null}},onLoad:function(t){var o=this;e.getSystemInfo({success:function(e){o.height=e.statusBarHeight,console.log("height"),console.log(o.height)}}),this.detailId=t.id,this.getOrderInfo(t.id)},methods:{copyOut:function(){console.log("复制"),e.setClipboardData({data:this.orderDetail.outTradeNo,success:function(){e.showToast({title:"复制成功",icon:"none"})}})},logistics:function(){console.log("查看物流"),e.navigateTo({url:"../soldPackage/logistics?id="+this.detailId})},deliverySure:function(){var t=this;console.log("确认收货"),e.request({url:this.$baseUrl+"/order/api/checkReceive",method:"POST",data:{id:this.detailId},header:{"content-type":"application/json",token:e.getStorageSync("token")},complete:function(o){console.log("确认收货"),console.log(o),200==o.statusCode?(t.getOrderInfo(t.detailId),e.showToast({icon:"none",title:"确认收货成功"})):e.showToast({icon:"none",title:o.data.message})}})},returnDetail:function(e){console.log("退款详情")},returnCancel:function(t){var o=this;e.showModal({content:"确定取消该退款？",confirmColor:"#85dbd0",success:function(n){n.confirm&&e.request({url:o.$baseUrl+"/afterService/api/refundSave",method:"POST",data:{id:t},header:{"content-type":"application/json",token:e.getStorageSync("token")},complete:function(t){e.showToast({icon:"none",title:"取消成功"}),o.getOrderInfo(o.detailId)}})}})},returnOrder:function(t){var o={productId:t.stockId,orderId:this.orderDetail.id,price:t.subTotal,phone:this.orderDetail.addressMsg.phone},n={pic:t.pic,state:this.orderDetail.orderStatus};e.navigateTo({url:"../soldPackage/returnType?params="+JSON.stringify(o)+"&productParams="+JSON.stringify(n)})},cancelOrder:function(){console.log("取消订单"),e.request({url:this.$baseUrl+"/order/api/closeOrder",method:"POST",header:{"content-type":"application/json",token:e.getStorageSync("token")},data:{outTradeNo:this.orderDetail.outTradeNo},complete:function(t){console.log("取消订单"),console.log(t),200==t.statusCode?(e.showToast({icon:"none",title:"取消成功"}),e.navigateTo({url:"orderList"})):e.showToast({icon:"none",title:t.data.message})}})},payOrder:function(){this.$refs.payPopup.open()},paySure:function(){var t=this;e.showLoading({title:""}),e.request({url:this.$baseUrl+"/wechat/api/payMsgGet",data:{id:this.orderDetail.id},header:{"content-type":"application/json",token:e.getStorageSync("token")},complete:function(o){e.hideLoading(),console.log("支付订单"),console.log(o),200==o.statusCode?(t.verification=o.data,console.log("微信小程序支付"),e.requestPayment({provider:"wxpay",timeStamp:t.verification.payMsg.timeStamp.toString(),nonceStr:t.verification.payMsg.nonceStr,package:t.verification.payMsg.package,signType:"RSA",paySign:t.verification.payMsg.paySign,success:function(e){console.log("success:"),console.log(e),t.getOrderList()},fail:function(e){console.log("fail:"),console.log(e)}})):e.showToast({icon:"none",title:o.data.message,duration:2e3})}})},delOrder:function(){var t=this;e.showModal({title:"删除订单",content:"确定要删除这个订单么 ？",confirmText:"删除",confirmColor:"#85dbd0",cancelColor:"#85dbd0",success:function(o){console.log(o),1==o.confirm&&(console.log("删除订单"),e.request({url:t.$baseUrl+"/order/api/orderDel",method:"POST",header:{"content-type":"application/json",token:e.getStorageSync("token")},data:{id:t.orderDetail.id},complete:function(t){console.log("res"),200==t.statusCode?(e.showToast({icon:"none",title:"删除成功"}),e.navigateTo({url:"orderList"})):e.showToast({icon:"none",title:t.data.message})}}))}})},getOrderInfo:function(t){var o=this;e.showLoading({title:"加载中..."}),e.request({url:this.$baseUrl+"/order/api/orderInfo?id="+t,header:{"content-type":"application/json",token:e.getStorageSync("token")},complete:function(t){if(e.hideLoading(),console.log("订单详情"),console.log(t),o.orderDetail=t.data,o.payPrice=0,o.orderDetail.detailList.length>0){var r,a=n(o.orderDetail.detailList);try{for(a.s();!(r=a.n()).done;){var i=r.value;o.payPrice+=Number(i.productPrice)}}catch(c){a.e(c)}finally{a.f()}}0==o.orderDetail.orderStatus&&setInterval((function(){var e=o.orderDetail.closeTime,t=Number(e-Date.parse(new Date))/1e3;console.log(Date.parse(new Date)),o.timeEnd=o.timeStamp(t)}),1e3)}})},timeStamp:function(e){if(!(e<=0)){var t="00时00分"+parseInt(e)+"秒";if(parseInt(e)>60){var o=parseInt(e)%60,n=parseInt(e/60);if(t="00时"+n+"分"+o+"秒",n>60){n=parseInt(e/60)%60;var r=parseInt(parseInt(e/60)/60);t=r+"时"+n+"分"+o+"秒"}}return console.log(t),t}},goBack:function(){e.navigateBack({delta:1})}}};t.default=i}).call(this,o(1)["default"])},293:function(e,t,o){"use strict";o.r(t);var n=o(294),r=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=r.a},294:function(e,t,o){}},[[287,"common/runtime","common/vendor","order/common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/order/orderDetail.js.map