(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["minePackage/inventory"],{2295:function(t,e,s){"use strict";s.r(e);var o=s("2a20"),a=s.n(o);for(var n in o)"default"!==n&&function(t){s.d(e,t,(function(){return o[t]}))}(n);e["default"]=a.a},"2a20":function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){s.e("components/popwnd/popwnd_select_blue").then(function(){return resolve(s("a3a6"))}.bind(null,s)).catch(s.oe)},a={components:{popwndSelect:o},data:function(){return{haveData:1,height:null,keyWord:"",page:1,bShowUser:!1,userIdx:0,usersList:[],bShowStock:!1,stockIdx:0,stocks:[],bShowState:!1,stateIdx:2,states:[{id:-1,name:"全部"},{id:0,name:"采购中"},{id:1,name:"存货"},{id:2,name:"客人预留"},{id:3,name:"已出售"}],list:[],total:0,sold1Total:0,reserveNum:0,soldNum:0,haveMore:0}},onLoad:function(){var e=this;t.getSystemInfo({success:function(t){e.height=t.statusBarHeight}}),this.stateIdx=2,0==this.list.length&&t.getStorageSync("token").length>0&&(console.log("重新获取数据"),this.getUserList(),this.getStockList())},onPullDownRefresh:function(){t.showLoading({title:"正在刷新"}),console.log("获取数据"),this.page=1,this.list=[],this.haveMore=0,this.getUserList(),this.getStockList(),t.stopPullDownRefresh()},onReachBottom:function(){0==this.haveMore&&(this.page++,this.search())},methods:{search:function(){var e=this;t.showLoading({title:"加载中..."}),this.soldNum=0,this.reserveNum=0;var s={};s={keyword:this.keyWord.trim(),userId:0,page:this.page,pageNum:10},"peer"==t.getStorageSync("role")?s.userId=0:s.userId=this.usersList[this.userIdx].id,this.stateIdx>0&&(s.sold=this.states[this.stateIdx].id),this.stockIdx>0&&(s.stockLoc=this.stocks[this.stockIdx]),t.request({url:this.$baseFileUrl+"/stockSearch",method:"POST",header:{"content-type":"application/json",token:t.getStorageSync("token")},data:s,complete:function(s){if(t.hideLoading(),0!=e.checkBack(s)){if(e.total=s.data.total,e.sold1Total=s.data.sold1Total,e.reserveNum=s.data.sold2Total,e.soldNum=s.data.soldTotal,0==s.data.list.length)e.haveMore=1;else{var o=e.list.concat(s.data.list);e.list=o}0==e.list.length?(e.haveData=0,t.showToast({icon:"none",title:"暂无数据"})):e.haveData=1}}})},getStockList:function(){var e=this;t.request({url:this.$baseFileUrl+"/stockLocList",header:{"content-type":"application/json",token:t.getStorageSync("token")},data:{},complete:function(s){t.hideLoading(),0!=e.checkBack(s,!0)&&s.data.length>0&&(e.stocks=s.data)}})},getUserList:function(){var e=this;t.request({url:this.$baseFileUrl+"/userList",header:{"content-type":"application/json",token:t.getStorageSync("token")},data:{},complete:function(s){t.hideLoading(),0!=e.checkBack(s,!0)&&(s.data.length>0&&(e.usersList=s.data),console.log("用户"),console.log(e.usersList),e.search())}})},inputChange:function(){this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},userChange:function(e){this.userIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},stockChange:function(e){this.stockIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},stateChange:function(e){this.stateIdx=e.sel,this.page=1,this.list=[],this.haveMore=0,this.search(),t.pageScrollTo({scrollTop:0,duration:300})},getSaleStateClr:function(t){return 0==t.sold?"#54b7eb":1==t.sold?"#6bcda5":2==t.sold?"#ff8b62":(t.sold,"#ef5b5b")},getSaleState:function(t){for(var e=0;e<this.states.length;++e){if(t.sold==this.states[e].id)return this.states[e].name;if(4==t.sold)return"已售"}return""},checkDetails:function(e){t.navigateTo({url:"../minePackage/details?id="+e.id})},goBack:function(){t.navigateBack({delta:1})}}};e.default=a}).call(this,s("543d")["default"])},4261:function(t,e,s){"use strict";s.r(e);var o=s("7ac7"),a=s("2295");for(var n in a)"default"!==n&&function(t){s.d(e,t,(function(){return a[t]}))}(n);s("ea2a");var i,l=s("f0c5"),r=Object(l["a"])(a["default"],o["b"],o["c"],!1,null,"84c1cf32",null,!1,o["a"],i);e["default"]=r.exports},7310:function(t,e,s){"use strict";(function(t){s("06ad");o(s("66fd"));var e=o(s("4261"));function o(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=s,t(e.default)}).call(this,s("543d")["createPage"])},"7ac7":function(t,e,s){"use strict";var o;s.d(e,"b",(function(){return a})),s.d(e,"c",(function(){return n})),s.d(e,"a",(function(){return o}));var a=function(){var t=this,e=t.$createElement,s=(t._self._c,0!=t.haveData?t.__map(t.list,(function(e,s){var o=t.__get_orig(e),a=e.pic.trim(),n=0==t.stateIdx?t.getSaleStateClr(e):null,i=0==t.stateIdx?t.getSaleState(e):null,l=0==e.sold?t.getPrice(e.hkdCost,"HKD"):null,r=1==e.sold?t.getPrice(e.hkdCost,"HKD"):null,c=1==e.sold?t.getPrice(e.hkdPricePeer,"HKD"):null,d=1==e.sold?t.getPrice(e.hkdPriceIndi,"HKD"):null,u=2==e.sold||3==e.sold||4==e.sold?t.getPrice(e.hkdCost,"HKD"):null,h=2==e.sold||3==e.sold||4==e.sold?t.getPrice(e.hkdPriceTran,"HKD"):null,g=2==e.sold||3==e.sold||4==e.sold?t.getPrice(e.hkdPriceTran-e.hkdCost,"HKD"):null;return{$orig:o,g0:a,m0:n,m1:i,m2:l,m3:r,m4:c,m5:d,m6:u,m7:h,m8:g}})):null);t._isMounted||(t.e0=function(e){t.bShowUser=!0},t.e1=function(e){t.bShowStock=!0},t.e2=function(e){t.bShowState=!0}),t.$mp.data=Object.assign({},{$root:{l0:s}})},n=[]},e859:function(t,e,s){},ea2a:function(t,e,s){"use strict";var o=s("e859"),a=s.n(o);a.a}},[["7310","common/runtime","common/vendor"]]]);